# Global Survey Topics ----

'https://drive.google.com/open?id=0B5qpmN53np2ueHpoVVZIdU9INGs'

# 2010 ----

cci_files_paths_2010 <- c(
'https://drive.google.com/open?id=0B5qpmN53np2uWVpxaFJIZWQ3VWM',
'https://drive.google.com/open?id=0B5qpmN53np2uZFJtdmt3RDlwaXM',
'https://drive.google.com/open?id=0B5qpmN53np2uOGEwT0FtcTZmYTQ',
'https://drive.google.com/open?id=0B5qpmN53np2uTDF1TEJqbFRaems',
'https://drive.google.com/open?id=0B5qpmN53np2udjNueWVMQ0MtTFU',
'https://drive.google.com/open?id=0B5qpmN53np2uejNSdUlhN01obE0',
'https://drive.google.com/open?id=0B5qpmN53np2uZkdFWUFlWjk3ZWc',
'https://drive.google.com/open?id=0B5qpmN53np2uT2tjOEgtR0lTUWM'
)

cci_files_names_2010 <- c(
'Q1 2010 ONL7760_Consumer_Confidence_Country_Wgt_(P)_2010-04-09',
'Q1 2010 ONL7760_Consumer_Confidence_Region_Wgt_(P)_2010-04-09',
'Q2 2010 ONL8192_Consumer Confidence_Country_Wgt_(P)_2010-06-22',
'Q2 2010 ONL8192_Consumer Confidence_Region_Wgt_(P)_2010-06-22',
'Q3 2010 ONL8420_Consumer_Confidence_Country_Wgt_(P)_2010-09-28',
'Q3 2010 ONL8420_Consumer_Confidence_Region_Wgt_(P)_2010-09-28',
"Q4 2010 ONL9304_Consumer_Confidence_(Q'4)_Country_Wgt_(P)_2010-12-24",
"Q4 2010 ONL9304_Consumer_Confidence_(Q'4)_Region_Wgt_(P)_2010-12-24"
)

cci_files_2010 <-
  data.frame(file_paths=cci_files_paths_2010, file_names=cci_files_names_2010)

# 2011 ----

cci_files_paths_2011 <- c(
'https://drive.google.com/open?id=0B5qpmN53np2uSTl4VzJoajE0VlU',
'https://drive.google.com/open?id=0B5qpmN53np2uYTdNd0Q3OEYtUFk',
'https://drive.google.com/open?id=0B5qpmN53np2uVkxCVUdnc25IWUk',
'https://drive.google.com/open?id=0B5qpmN53np2uam5Zd09icFo3a0U',
'https://drive.google.com/open?id=0B5qpmN53np2uVm5janhNek5Lc1k',
'https://drive.google.com/open?id=0B5qpmN53np2ucVlaVGxibUdoXzg',
'https://drive.google.com/open?id=0B5qpmN53np2uUkJCOVhJWm9RdDA',
'https://drive.google.com/open?id=0B5qpmN53np2uR01ZajQybUM2aEU'
)

cci_files_names_2011 <- c(
  "Q1 2011 ONL9862_Consumer Confidence Q1 2011_Country_Wgt_(P)_2011-04-20"
)

# 2012 ----

cci_files_2012 <- c(
'https://drive.google.com/open?id=0B5qpmN53np2uR2JuYkpkWTI0NTQ',
'https://drive.google.com/open?id=0B5qpmN53np2uR19SVkNkR1dDSm8',
'https://drive.google.com/open?id=0B5qpmN53np2uMDl6RTZEYnhpUFE',
'https://drive.google.com/open?id=0B5qpmN53np2uNDNNUFAzWWhHVVE',
'https://drive.google.com/open?id=0B5qpmN53np2uNmtmUUhEXzJROVk',
'https://drive.google.com/open?id=0B5qpmN53np2uLVZ4RmVGU3kyelU',
'https://drive.google.com/open?id=0B5qpmN53np2uYURQcEJQMmxOVTg',
'https://drive.google.com/open?id=0B5qpmN53np2ubHNqX1VQeWVlNkk'
)

# 2013 ----

cci_files_2013 <- c(
'https://drive.google.com/open?id=0B5qpmN53np2udGJFUFk1THJRWTQ',
'https://drive.google.com/open?id=0B5qpmN53np2uY0lMSXhzVDU2c1U',
'https://drive.google.com/open?id=0B5qpmN53np2uZzdnRGxkX3hfZ2s',
'https://drive.google.com/open?id=0B5qpmN53np2udjBxY1IzSmpGMVk',
'https://drive.google.com/open?id=0B5qpmN53np2uU055V2RhSnktalE',
'https://drive.google.com/open?id=0B5qpmN53np2uc1lLNllpNWpiOWs',
'https://drive.google.com/open?id=0B5qpmN53np2udmw5c1I0VEhOR2c',
'https://drive.google.com/open?id=0B5qpmN53np2uYlVGZGZnd3ZOaWc'
)

# 2014 ----

cci_files_2014 <- c(
'https://drive.google.com/open?id=0B5qpmN53np2uTV9OOS13RGNDUlk',
'https://drive.google.com/open?id=0B5qpmN53np2uTGYtbUYxUUNXZEk',
'https://drive.google.com/open?id=0B5qpmN53np2uczAtamNaMWZBUTQ',
'https://drive.google.com/open?id=0B5qpmN53np2uRjFqdV9kenZUOWs',
'https://drive.google.com/open?id=0B5qpmN53np2uaGd2SVJ5ZHlRMjA',
'https://drive.google.com/open?id=0B5qpmN53np2uc25zdlhSYkd4TUk',
'https://drive.google.com/open?id=0B5qpmN53np2uUGg1NFhVZDV6dTg',
'https://drive.google.com/open?id=0B5qpmN53np2uSi1GYkpFSGRKMzQ'
)

# 2015 ----

cci_files_2015 <- c(
'https://drive.google.com/open?id=0B5qpmN53np2uTGd6TVZ6dWZjU3c',
'https://drive.google.com/open?id=0B5qpmN53np2uQ2hoaEpyTUNBNEU',
'https://drive.google.com/open?id=0B5qpmN53np2uM1lMenBzSGRldm8',
'https://drive.google.com/open?id=0B5qpmN53np2uVVFaMTZyRmNna28',
'https://drive.google.com/open?id=0B5qpmN53np2uREQ5Vm1WV3FybHc',
'https://drive.google.com/open?id=0B5qpmN53np2ubzY1TDVVNnNJdjQ',
'https://drive.google.com/open?id=0B5qpmN53np2udzJ5TjNUYTU2eEk',
'https://drive.google.com/open?id=0B5qpmN53np2uQ3Z3S1haTkc3OEk'
)

# 2016 ----

cci_files_2016 <- c(
'https://drive.google.com/open?id=0B5qpmN53np2uS2pYb2d4eURaZ0k',
'https://drive.google.com/open?id=0B5qpmN53np2ua3YtV3pzT2FFcEk',
'https://drive.google.com/open?id=0B5qpmN53np2uaDIyVVlqaGpCLU0',
'https://drive.google.com/open?id=0B5qpmN53np2ucUJLdEtMbU43bDg'
)

# Read Files ----

source(file.path(Rdir,"libraries.R"))

datain <- "~/projects/thought_leadership"
setwd(paste0(datain,"/files_cci_drive"))

fileURL <- cci_files_2010[1, ]$file_paths
fileOut <- "temp.xls"
bindat <- getBinaryURL(fileURL)
writeBin(bindat,fileOut)

ls()

dataIn <- loadWorkbook('temp.xls')

sheets <- getSheets(dataIn)

outfile <- ""

for (sheetNr in 1:length(sheets)) {
  
  #sheetNr <- 1
  
  infile = readWorksheet(dataIn, sheet = sheets[sheetNr],useCachedValues=FALSE,
                         startRow=1, endRow=nrRows, startCol=1, endCol=nrCols, header=F)
  
